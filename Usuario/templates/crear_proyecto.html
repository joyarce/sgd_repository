<!-- crear_proyecto.html -->
{% extends "base.html" %}
{% block title %}Nuevo Proyecto{% endblock %}

{% block extra_css %}
<style>
/*  Estilos idénticos a tu plantilla original */
:root {
  --metso-dark-gray: #333;
  --metso-light-gray: #f7f7f7;
  --metso-orange: #f36f21;
  --metso-orange-hover: #d65c1a;
  --metso-white: #fff;
  --metso-border-radius: 10px;
}
body { background-color: var(--metso-light-gray); font-family: 'Inter', sans-serif; margin:0; }
.container {
  max-width: 1100px; margin: 40px auto; padding: 0 20px; color: var(--metso-dark-gray);
}
h1 { font-size: 2.2rem; font-weight: 700; margin-bottom: 5px; }
.subtitle { color: #6a6a6a; margin-bottom: 30px; font-size: 1rem; }

.card {
  background: var(--metso-white); border-radius: var(--metso-border-radius);
  box-shadow: 0 5px 15px rgba(0,0,0,0.05); padding: 30px;
  margin-bottom: 25px; border: 1px solid #eee; transition: all 0.2s ease;
}
label { display:block; margin-top:15px; margin-bottom:6px; font-weight:600; font-size: 0.95rem; }
input, select, textarea {
  width:100%; padding:12px; border:1px solid #e0e0e0; border-radius:var(--metso-border-radius);
  font-size:15px; background:#fcfcfc; transition:border-color 0.2s, box-shadow 0.2s;
}
input:focus, select:focus, textarea:focus {
  border-color: var(--metso-orange); box-shadow:0 0 0 3px rgba(243,111,33,0.2);
  background:#fff; outline:none;
}
textarea { resize: vertical; min-height: 100px; }

button.btn {
  background-color: var(--metso-orange); color: var(--metso-white);
  border:none; padding:12px 25px; border-radius:var(--metso-border-radius);
  font-size:15px; cursor:pointer; font-weight:600;
  transition: background 0.2s, transform 0.1s, box-shadow 0.2s;
  box-shadow:0 4px 8px rgba(243,111,33,0.2);
}
button.btn:hover {
  background-color: var(--metso-orange-hover);
  transform: translateY(-1px);
  box-shadow:0 6px 12px rgba(243,111,33,0.3);
}
button.btn:active {
  transform: translateY(1px);
  box-shadow:0 2px 4px rgba(243,111,33,0.2);
}
.btn-secondary { background-color:#aaa; box-shadow: none; }
.btn-secondary:hover { background-color:#999; }

/* === Barra de progreso === */
.progress-bar {
  display:flex; justify-content:space-between; margin-bottom:40px; padding:0 10%;
}
.step { text-align:center; position:relative; }
.step-circle {
  width:35px; height:35px; border-radius:50%;
  background:#ccc; color:#fff; line-height:35px; font-weight:600;
  margin:0 auto 8px; transition:background 0.3s; border:3px solid #fff;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
}
.step-circle.active { background-color: var(--metso-orange); }
.step-label { font-size:13px; color:#6a6a6a; }
.progress-line {
  position:absolute; top:17px; height:3px; background-color:#ddd; z-index:-1;
}
.step:not(:last-child) .progress-line {
  left: calc(50% + 17.5px); right: calc(-50% + 17.5px); width:100%;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
  <h1>Crear Proyecto</h1>
  <p class="subtitle">Flujo de trabajo multi-paso para el registro de un nuevo proyecto.</p>

  <!--  Barra de progreso -->
  <div class="progress-bar">
    {% for label in steps %}
      <div class="step">
        <div class="step-circle {% if forloop.counter <= paso_actual|add:'0' %}active{% endif %}">

          {{ forloop.counter }}
        </div>
        <div class="step-label">{{ label }}</div>
        <div class="progress-line"></div>
      </div>
    {% endfor %}
  </div>

  <!--  Formulario principal -->
  <form method="POST">
    {% csrf_token %}
    <input type="hidden" name="paso_actual" value="{{ paso_actual|default:'1' }}">

    <div class="card">
      {% if paso_actual == '1' %}
        {% include "flujo_paso1.html" %}
      {% elif paso_actual == '2' %}
        {% include "flujo_paso2.html" %}
      {% elif paso_actual == '3' %}
        {% include "flujo_paso3.html" %}
      {% elif paso_actual == '4' %}
        {% include "flujo_paso4.html" %}
      {% endif %}
    </div>

    <!--  Navegación -->
    <div style="text-align:right; margin-top:30px;">
      {% if paso_actual != '1' %}
        <button type="submit" class="btn btn-secondary" name="accion" value="anterior">← Anterior</button>
      {% endif %}
      {% if paso_actual != '4' %}
        <button type="submit" class="btn" name="accion" value="siguiente">Siguiente →</button>
      {% else %}
        <button type="submit" class="btn" name="accion" value="confirmar"> Confirmar y Crear</button>
      {% endif %}
    </div>
  </form>
</div>
{% endblock %}
