<!-- usuario_usuarios.html -->

{% extends "base.html" %}

{% block title %}Usuarios del Sistema | Gestión Documental{% endblock %}

{% block extra_css %}
<style>
:root {
    --metso-dark-gray: #333;
    --metso-white: #fff;
    --metso-orange: #f36f21;
    --metso-blue: #007bff;
    --metso-light-gray: #f7f9fb;
    --text-primary: #333;
    --text-secondary: #6c757d;
    --hover-bg: rgba(243, 111, 33, 0.05);
}

.container {
    max-width: 1100px;
    margin: 30px auto;
    padding: 0 15px;
}

h1 {
    text-align: center;
    color: var(--text-primary);
    font-weight: 600;
    margin-bottom: 25px;
    font-family: 'Poppins', sans-serif;
    font-size: 1.6rem;
}

.table-wrapper {
    background: var(--metso-white);
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    overflow-x: hidden;
    border: 1px solid #e0e0e0;
}

table {
    width: 100%;
    border-collapse: collapse;
    table-layout: auto; /* Ajusta columnas automáticamente */
}

th, td {
    padding: 8px 10px;
    font-size: 0.85rem;
    text-align: left;
    border-bottom: 1px solid #f0f0f0;
    vertical-align: middle;
    word-wrap: break-word;
    color: var(--text-primary);
}

th {
    background: var(--metso-light-gray);
    color: var(--text-secondary);
    font-weight: 700;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.5px;
}

tr:hover {
    background: var(--hover-bg);
    transition: background 0.2s ease;
}

/* Ajuste de ancho de columnas */
td:nth-child(1) { width: auto; } /* Nombre */
td:nth-child(2) { width: auto; } /* Contacto */
td:nth-child(3) { width: 15%; }  /* Área / Cargo */
td:nth-child(4) { width: 10%; }  /* Registro */
td:last-child { width: 10%; text-align:center; } /* Acciones */

/* Vertical stack para contacto y área/cargo */
.vertical-stack span { 
    display: block; 
    line-height: 1.3; 
}
.vertical-stack span:not(:first-child) {
    font-size: 0.75rem;
    color: var(--text-secondary);
}
.vertical-stack i {
    margin-right: 5px;
    width: 15px;
    text-align: center;
    color: var(--metso-orange);
}

/* Botones de acción */
.action-buttons { display: flex; gap: 4px; justify-content: center; }
.action-buttons a { 
    width: 26px; height: 26px; 
    display: flex; justify-content:center; align-items:center; 
    border-radius: 4px;
    color: var(--metso-white); 
    text-decoration: none;
    transition: all 0.2s ease; 
    font-size:0.75rem; 
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.edit-btn { background: var(--metso-orange); }
.edit-btn:hover { background: #e65b00; transform: scale(1.05); }
.view-stats-btn { background: #5a6270; }
.view-stats-btn:hover { background: #4a515c; transform: scale(1.05); }

.text-muted { color: #777 !important; font-size: 0.8rem; }
td:empty::before { content: '-'; color: #ccc; }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <h1>Usuarios del Sistema</h1>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Contacto</th>
                    <th>Área / Cargo</th>
                    <th>Registro</th>
                    <th style="text-align:center;">Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% if usuarios %}
                    {% for user in usuarios %}
                    <tr>
                        <td>{{ user.nombre }}</td>
                        <td class="vertical-stack">
                            <span title="Email corporativo"><i class="fas fa-envelope"></i>{{ user.email_corporativo }}</span>
                            {% if user.email_secundario %}
                                <span title="Email secundario"><i class="far fa-envelope"></i>{{ user.email_secundario }}</span>
                            {% endif %}
                            {% if user.telefono_corporativo %}
                                <span title="Tel. corporativo"><i class="fas fa-phone-alt"></i>{{ user.telefono_corporativo }}</span>
                            {% endif %}
                            {% if user.telefono_secundario %}
                                <span title="Tel. secundario"><i class="fas fa-mobile-alt"></i>{{ user.telefono_secundario }}</span>
                            {% endif %}
                        </td>
                        <td class="vertical-stack">
                            <span>{{ user.area_trabajo }}</span>
                            <span>{{ user.cargo }}</span>
                        </td>
                        <td class="vertical-stack">
                            <span>{% if user.fecha_registro %}{{ user.fecha_registro|date:"d M Y" }}{% else %}-{% endif %}</span>
                            <span style="font-size: 0.7rem; color: #999;">{% if user.fecha_registro %}{{ user.fecha_registro|date:"H:i" }} hrs{% endif %}</span>
                        </td>
                        <td style="text-align:center;">
                            <div class="action-buttons">
                                <a class="edit-btn" href="{% url 'usuario:editar_usuario' user.id %}" title="Editar usuario"><i class="fas fa-user-cog"></i></a>
                                <a class="view-stats-btn" href="{% url 'usuario:ver_estadisticas_usuario' user.id %}" title="Ver estadísticas">
                                    <i class="fas fa-chart-bar"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="5" style="text-align:center; padding: 20px;" class="text-muted">❌ No hay usuarios registrados en el sistema.</td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
